plugins {
    // Makes building the docker image a dependency of Gradle's "build" command. This way you could run your entire build inside a docker image
    // via ./gradlew :airbyte-integrations:connectors:source-mongodb:build
    id 'airbyte-docker'
    id 'airbyte-standard-source-test-file'
}

airbyteStandardSourceTestFile {
    def dbName = "mongo-test-${System.currentTimeMillis()}"
    prehook {
        project.exec {
            def args = ["docker", "run",
                        "--rm",
                        "-v", "${project.path}/bin:/docker-entrypoint-initdb.d",
                        "--name", dbName,
                        "mongo:4.0.23"]
        }
        println('HOOOOOHOHOHOHOHOHOOHello')
        logger.error("HOOOOOHOHOHOHOHOHOOHello")
    }

    posthook {
        logger.error("HOOOOOHOHOHOHOHOHOOHello BYEYBYEYBYE")
    }

    // All these input paths must live inside this connector's directory (or subdirectories)
    configPath = "secrets/valid_config.json"
    configuredCatalogPath = "secrets/fullrefresh_configured_catalog.json"
    specPath = "lib/spec.json"
}

dependencies {
    implementation files(project(':airbyte-integrations:bases:base-standard-source-test-file').airbyteDocker.outputs)
}
